import"./modulepreload-polyfill-3cfb730f.js";let m=JSON.parse(localStorage.getItem("carrito"))||[];const C=document.getElementById("cart-desktop"),I=document.getElementById("cart-mobile"),E=document.getElementById("carrito-popup"),v=document.getElementById("cerrar-carrito");C.addEventListener("click",()=>{E.classList.add("open"),f()});I.addEventListener("click",()=>{E.classList.add("open"),f()});v.addEventListener("click",()=>{E.classList.remove("open")});function f(){const o=document.getElementById("carrito-contenido");o.innerHTML="",m.length===0&&(o.innerHTML="<p>No hay productos en el carrito.</p>");let i=0;m.forEach((n,a)=>{const t=document.createElement("div");t.classList.add("carrito-item"),t.innerHTML=`
            <img src="${n.imagen}" alt="${n.nombre}">
            <div class="nombre">${n.nombre}</div>
            <div class="precio">${n.precio.toLocaleString("es-CL")} CLP</div>
            <div class="eliminar" data-index="${a}">❌</div>
        `,o.appendChild(t),i+=n.precio}),document.getElementById("total-precio").textContent=i.toLocaleString("es-CL"),document.querySelectorAll(".carrito-item .eliminar").forEach(n=>{n.addEventListener("click",a=>{const t=a.target.getAttribute("data-index");m.splice(t,1),localStorage.setItem("carrito",JSON.stringify(m)),f()})})}document.getElementById("vaciar-carrito").addEventListener("click",()=>{m=[],localStorage.setItem("carrito",JSON.stringify(m)),f()});document.querySelector("#carrito-popup .checkout-btn").addEventListener("click",()=>{window.location.href="/checkout.html"});function $(o){m.push(o),localStorage.setItem("carrito",JSON.stringify(m)),f()}document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("hamburguer-menu"),i=document.getElementById("close-menu"),c=document.getElementById("hamburguer-menu-list");o.addEventListener("click",function(){c.classList.remove("hidden")}),i.addEventListener("click",function(){c.classList.add("hidden")}),c.addEventListener("click",function(n){n.target===c&&c.classList.add("hidden")})});function S(){const o=document.getElementById("notificacion-carrito");o.classList.remove("hidden"),o.classList.add("opacity-100"),setTimeout(()=>{o.classList.add("hidden"),o.classList.remove("opacity-100")},2e3)}let h=[];document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("productos");async function i(){try{const n=await fetch("https://fortniteapi.io/v2/shop?lang=es-419&includeRenderData=false",{headers:{Authorization:"11b1a0cd-5fdf5d92-62c4e04b-7356366c"}});if(!n.ok)throw new Error("Error al obtener los datos de la API");h=(await n.json()).shop,c(h)}catch(n){console.error("❌ Error al cargar la API:",n)}}function c(n){o.innerHTML="";let a={};n.forEach(t=>{var r,e,l,s,p,g,y,b,L;let u=t.displayType||"No especificado";const d=((r=t.section)==null?void 0:r.name)||u||"Otros";a[d]||(a[d]=[]),a[d].push({nombre:t.displayName,precio:t.price.finalPrice,imagen:(l=(e=t.displayAssets)==null?void 0:e[0])==null?void 0:l.url,descripcion:t.displayDescription||t.description||"Sin descripción disponible",grupo:((s=t.series)==null?void 0:s.name)||((p=t.set)==null?void 0:p.name)||"Sin categoría",tipo:u,descuento:((g=t.banner)==null?void 0:g.name)||null,inicio:((y=t.offerDates)==null?void 0:y.in)||null,fin:((b=t.offerDates)==null?void 0:b.out)||null,rareza:((L=t.rarity)==null?void 0:L.name)||"Sin rareza",colorfondo:t.colors.color1})}),Object.entries(a).forEach(([t,u])=>{const d=document.createElement("h2");d.textContent=t,d.className="category-title",o.appendChild(d);const r=document.createElement("div");r.className="product-container",u.forEach(e=>{const l=document.createElement("div");l.classList.add("product-card"),l.innerHTML=`
          ${e.descuento?`<div class="discount-banner">${e.descuento}</div>`:""}
          <div class="product-image" style="background-color: ${e.colorfondo};"> <img src="${e.imagen}" alt="${e.nombre}"> </div>
          <div class="product-info">
              <h3>${e.nombre}</h3>
              <p><strong>Rareza:</strong> ${e.rareza}</p>
              <div class="price">
                  <span class="new-price">$${(e.precio*4.4).toLocaleString("es-CL")} CLP</span>
              </div>
          </div>
          <button class="carrito" data-product="${e.nombre}" data-price="${e.precio}" data-imagen="${e.imagen}">
              <img src="https://lh3.googleusercontent.com/d/1G3MVAV9knIYqiLI6cI7gwKob6Vuvo5MC=s220?authuser=0" alt="Añadir al carrito">
          </button>
        `,l.querySelector(".carrito").addEventListener("click",s=>{s.stopPropagation();const p=s.target.closest("button").dataset.product,g=s.target.closest("button").dataset.price*4.4,y=s.target.closest("button").dataset.imagen;$({nombre:p,precio:g,imagen:y}),S()}),l.addEventListener("click",s=>{if(!s.target.closest(".carrito")){const p=e.descripcion||"Sin descripción disponible",g=e.fin||"Fecha no disponible";window.location.href=`detalleproducto.html?nombre=${encodeURIComponent(e.nombre)}&precio=${encodeURIComponent(e.precio)}&imagen=${encodeURIComponent(e.imagen)}&partOf=${encodeURIComponent(e.grupo)}&mainType=${encodeURIComponent(e.tipo)}&descripcion=${encodeURIComponent(p)}&fecha=${encodeURIComponent(e.inicio||"Fecha no disponible.")}&out=${encodeURIComponent(g)}&mensajeSalida=${encodeURIComponent(e.mensajeSalida||"")}&rareza=${encodeURIComponent(e.rareza)}&partede=${encodeURIComponent(e.grupo)}&imgbundle=${encodeURIComponent(e.bundle||"")}&imgbundle2=${encodeURIComponent(e.bundle2||"")}&imgbundle3=${encodeURIComponent(e.bundle3||"")}&imgbundle4=${encodeURIComponent(e.bundle4||"")}&colorFondo=${encodeURIComponent(e.colorfondo||"")}`}}),r.appendChild(l)}),o.appendChild(r)})}document.getElementById("buscador").addEventListener("input",function(){const n=this.value.toLowerCase();if(n==="")c(h);else{const a=h.filter(t=>t.displayName.toLowerCase().includes(n));c(a)}}),i()});function k(){const o=new Date,i={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0};return o.toLocaleString("es-ES",i)}document.getElementById("fecha-actual").textContent=k();document.querySelector("#carrito-popup .total button").addEventListener("click",()=>{window.location.href="checkout.html"});document.getElementById("buscador").addEventListener("input",function(){const o=this.value.toLowerCase(),i=document.querySelectorAll(".category-title");if(o===""){B();return}i.forEach(c=>{const n=c.nextElementSibling,a=n.querySelectorAll(".product-card");let t=!1;a.forEach(u=>{const r=u.querySelector("h3").textContent.toLowerCase().includes(o);u.style.display=r?"block":"none",r&&(t=!0)}),t?(c.style.display="block",n.style.display=""):(c.style.display="none",n.style.display="none")})});function B(){document.querySelectorAll(".category-title").forEach(i=>{const c=i.nextElementSibling,n=c.querySelectorAll(".product-card");i.style.display="block",c.style.display="",n.forEach(a=>{a.style.display="block"})})}
